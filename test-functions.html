<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠŸèƒ½æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background: #007bff;
            color: white;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <h1>ğŸµ éŸ³æ¨‚å’Œä¸»é¡ŒåŠŸèƒ½æ¸¬è©¦</h1>
    
    <div class="test-section">
        <h2>éŸ³æ¨‚æ§åˆ¶æ¸¬è©¦</h2>
        <button class="button" onclick="testMusic()">æ¸¬è©¦éŸ³æ¨‚æ’­æ”¾</button>
        <button class="button" onclick="testFallbackAudio()">æ¸¬è©¦å‚™ç”¨éŸ³é »</button>
        <div id="musicStatus" class="status">éŸ³æ¨‚ç‹€æ…‹ï¼šæœªé–‹å§‹</div>
    </div>
    
    <div class="test-section">
        <h2>ä¸»é¡Œåˆ‡æ›æ¸¬è©¦</h2>
        <button class="button" onclick="testTheme()">åˆ‡æ›ä¸»é¡Œ</button>
        <div id="themeStatus" class="status">ç•¶å‰ä¸»é¡Œï¼š<span id="currentTheme">dark</span></div>
    </div>
    
    <div class="test-section">
        <h2>ç„¡ç‰ˆæ¬ŠéŸ³æ¨‚é€£çµæ¸¬è©¦</h2>
        <div id="musicLinks"></div>
    </div>

    <script>
        // æ¸¬è©¦éŸ³æ¨‚åŠŸèƒ½
        let testAudio = null;
        let audioFallback = null;

        function testMusic() {
            const status = document.getElementById('musicStatus');
            
            if (!testAudio) {
                testAudio = new Audio();
                // ä½¿ç”¨ Pixabay å…è²»éŸ³æ¨‚
                testAudio.src = 'https://cdn.pixabay.com/audio/2022/03/21/audio_4bb50f1ded.mp3';
                testAudio.loop = true;
                testAudio.volume = 0.3;
                
                testAudio.addEventListener('loadstart', () => {
                    status.textContent = 'éŸ³æ¨‚ç‹€æ…‹ï¼šé–‹å§‹è¼‰å…¥...';
                });
                
                testAudio.addEventListener('canplay', () => {
                    status.textContent = 'éŸ³æ¨‚ç‹€æ…‹ï¼šæº–å‚™æ’­æ”¾';
                });
                
                testAudio.addEventListener('playing', () => {
                    status.textContent = 'éŸ³æ¨‚ç‹€æ…‹ï¼šæ­£åœ¨æ’­æ”¾ âœ…';
                });
                
                testAudio.addEventListener('pause', () => {
                    status.textContent = 'éŸ³æ¨‚ç‹€æ…‹ï¼šå·²æš«åœ';
                });
                
                testAudio.addEventListener('error', (e) => {
                    status.textContent = 'éŸ³æ¨‚ç‹€æ…‹ï¼šè¼‰å…¥å¤±æ•— âŒ - ' + e.message;
                    console.error('éŸ³æ¨‚è¼‰å…¥éŒ¯èª¤:', e);
                });
            }
            
            if (testAudio.paused) {
                testAudio.play().catch(error => {
                    status.textContent = 'éŸ³æ¨‚ç‹€æ…‹ï¼šæ’­æ”¾å¤±æ•— - ' + error.message;
                });
            } else {
                testAudio.pause();
            }
        }

        function testFallbackAudio() {
            const status = document.getElementById('musicStatus');
            
            if (!audioFallback) {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    
                    oscillator.start();
                    
                    audioFallback = { oscillator, gainNode, audioContext, isPlaying: true };
                    status.textContent = 'å‚™ç”¨éŸ³é »ç‹€æ…‹ï¼šæ’­æ”¾ä¸­ âœ…';
                    
                    setTimeout(() => {
                        oscillator.stop();
                        audioFallback = null;
                        status.textContent = 'å‚™ç”¨éŸ³é »ç‹€æ…‹ï¼šå·²åœæ­¢';
                    }, 3000);
                    
                } catch (error) {
                    status.textContent = 'å‚™ç”¨éŸ³é »ç‹€æ…‹ï¼šä¸æ”¯æ´ âŒ - ' + error.message;
                }
            }
        }

        function testTheme() {
            const currentThemeSpan = document.getElementById('currentTheme');
            const currentTheme = currentThemeSpan.textContent;
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            currentThemeSpan.textContent = newTheme;
            
            // è¦–è¦ºåé¥‹
            document.body.style.background = newTheme === 'light' ? '#f8f9fa' : '#212529';
            document.body.style.color = newTheme === 'light' ? '#212529' : '#f8f9fa';
        }

        // é¡¯ç¤ºéŸ³æ¨‚é€£çµæ¸¬è©¦
        function displayMusicLinks() {
            const musicLinks = [
                'https://cdn.pixabay.com/audio/2022/03/21/audio_4bb50f1ded.mp3',
                'https://cdn.pixabay.com/audio/2022/03/10/audio_d24b2c4eb3.mp3',
                'https://cdn.pixabay.com/audio/2022/01/18/audio_f645888b26.mp3'
            ];
            
            const container = document.getElementById('musicLinks');
            container.innerHTML = '<h3>æ¸¬è©¦éŸ³æ¨‚é€£çµï¼š</h3>';
            
            musicLinks.forEach((link, index) => {
                const linkElement = document.createElement('p');
                linkElement.innerHTML = `
                    <strong>éŸ³æ¨‚ ${index + 1}:</strong> 
                    <a href="${link}" target="_blank">æ¸¬è©¦é€£çµ</a>
                    <button class="button" onclick="testSpecificMusic('${link}', ${index + 1})">æ’­æ”¾æ¸¬è©¦</button>
                    <span id="status${index + 1}"></span>
                `;
                container.appendChild(linkElement);
            });
        }

        function testSpecificMusic(url, index) {
            const status = document.getElementById(`status${index}`);
            const audio = new Audio(url);
            
            status.textContent = ' è¼‰å…¥ä¸­...';
            
            audio.addEventListener('canplay', () => {
                status.textContent = ' âœ… å¯æ’­æ”¾';
                audio.play().then(() => {
                    status.textContent = ' âœ… æ’­æ”¾ä¸­';
                    setTimeout(() => {
                        audio.pause();
                        status.textContent = ' â¸ï¸ æ¸¬è©¦å®Œæˆ';
                    }, 2000);
                });
            });
            
            audio.addEventListener('error', () => {
                status.textContent = ' âŒ è¼‰å…¥å¤±æ•—';
            });
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œé¡¯ç¤ºéŸ³æ¨‚é€£çµ
        document.addEventListener('DOMContentLoaded', displayMusicLinks);
    </script>
</body>
</html>
